

#include <stdio.h>
#include "platform.h"
#include "xparameters.h"
#include "xil_io.h"
#include "xil_printf.h"
#include "puf_driver.h"

#define chall_number 400


int main()
{
    init_platform();
    u64 challenge_array1[chall_number]={0xAC5EBC125D1F1DD5,
    		0x1B455DA079B39D80,
    		0x9F8B1BC6B52EFCDA,
    		0x27BA6120396C720D,
    		0xB12239933413211C,
    		0x24C5C8231151E902,
    		0x87FB626AA91FC2AD,
    		0x6004F9DA58F8344A,
    		0x9E3B65BA7C875055,
    		0xE0FECF7A5CC42DE3,
    		0xD8A7A98B8DAFCC83,
    		0xB90A382D241559D6,
    		0x22BF71050F180E65,
    		0x0E4366DC62125E1C,
    		0x0FD937B2040D592A,
    		0x021377FE032B755C,
    		0x3F647BD068DDD042,
    		0xE299A544F186DB05,
    		0x0D26065568063EE6,
    		0xFA3383F78F1D30DC,
    		0x39BAC5802D299D4F,
    		0xC00C04DB2E035CEF,
    		0xDEF73B41398F3A60,
    		0x5F5B251ED6CB40BC,
    		0x1069AD068F0849B6,
    		0x0B96634821C2C624,
    		0x50307FC13A329116,
    		0xE6F6BF009BD71ABA,
    		0xE373DB2A63743AC6,
    		0x57BAEE6B9CBE2D46,
    		0x35F48550700846F9,
    		0x589951D62E16A997,
    		0x06837CB2ED49B3AD,
    		0xC71371AC9E56EAB1,
    		0x5DBB85B8EE3E05C1,
    		0x7145DD0157B01DE6,
    		0xC77FDA47DB259F2C,
    		0x7718904539F0E765,
    		0xB79A789165CF8129,
    		0xF31032C8042C1371,
    		0x063F32F5B08DBF6D,
    		0x8605058C04214358,
    		0x36AB1C740462D7EA,
    		0xBE64760A38CCFB1F,
    		0x377419087544F3FF,
    		0xB18C5AEA9B170E4B,
    		0x484025C3003661F6,
    		0xB1BBD0CD5EEC4E60,
    		0xCFBBCD10E51BEEE3,
    		0x2C56078EBE50F9EB,
    		0xAD097F754AC123BD,
    		0x2DF9444C7356DB46,
    		0x96835A4D4EB1FF38,
    		0x7C3DC0CEDEF04A92,
    		0xD08E1C15CE09AF86,
    		0x17DCBFF4D10E7047,
    		0x2F037A1132126DFD,
    		0x50C9EAE275324C5D,
    		0xBC180B4D46251AF2,
    		0xD9B10588DEC360B2,
    		0xD5CD508F1B7C64E4,
    		0x55321E9E4EE28D74,
    		0x20AB28B2B335C4D7,
    		0x7940FB990F3B1A0B,
    		0xCB7200D99983037D,
    		0x7BCB26A0B89EA97F,
    		0x67226E5D08453540,
    		0xF8CDDB09DAEB27FD,
    		0x5FCE91F795A1BB4C,
    		0xA8803C036AD23EC2,
    		0x46F07BA0493CB835,
    		0x4263E578FBB645EB,
    		0xAC064CB00263568E,
    		0xB386EE89AC52E44E,
    		0xB6C2F6508B833D17,
    		0xD8F819148C140D1C,
    		0xF87870A623073FA9,
    		0xAF6C750A4C92B0F9,
    		0xC44500705418FE1D,
    		0x090ABE79E536DD58,
    		0xCF73CAD719BEF848,
    		0x6A961FD083B1B9FD,
    		0xC4688D2292992B7F,
    		0x62CCEC04E7EAFDE8,
    		0x6E9134CDC3896B31,
    		0x91525BF3DC4CFD70,
    		0xD17B8CCD8FF8C811,
    		0xBC9DC1BD62954D9F,
    		0x654FC0AB025577B5,
    		0x9F82CBFF678E7009,
    		0xE379FB2ABBD85B0D,
    		0x41B3CDD04C717178,
    		0xBF9AD1BF6C872FB3,
    		0xDDB57FE36735E812,
    		0xE3435BA5FE3FB77E,
    		0x53FE1EF08C55DFBB,
    		0x27CA037EDA40CCCB,
    		0x89754DA84FB7A27F,
    		0xF1A07DBC957FA677,
    		0xA01EB604A72643FB,
    		0x7A27516DCC74195C,
    		0x2C99172EB9FDBDE4,
    		0x2BA61703793EE422,
    		0x00DF10A6F429ECCB,
    		0x1F9A063E88E166C6,
    		0x62FA824B7430A320,
    		0xF0D3060A40D9E357,
    		0xBD3E8BCDE80A5A9B,
    		0x446573B6FE9CB757,
    		0x43B170AEEC2F3CDD,
    		0x3BD6F917E2336EEF,
    		0x49DABA549136FE60,
    		0x3D1E47AC6637361D,
    		0x9A1C569E83DA8083,
    		0xE57647FB4D97F617,
    		0x329F484C5F28B8D0,
    		0xE87E35C3B95B576A,
    		0x5BAFD267E599A662,
    		0x517EB98F43A0D370,
    		0x276666ABD53A8374,
    		0x3AE0671CDE095809,
    		0xF59861BDE4F12596,
    		0x8C24835FAC75B3D7,
    		0x4223729CFDF8B2C9,
    		0x5A50AF36889B0B4C,
    		0x2C672D7A6B28766D,
    		0xED7493C93A911DCC,
    		0x823D9FEC4FF94E88,
    		0x342D8AA93DEC2BD6,
    		0x33BD67F34A3B36C1,
    		0x31DAB2B5A6559715,
    		0x836786CA4626FABB,
    		0x7E6E3D4958F9BA71,
    		0x3FB1AC129E2545A2,
    		0x5F1BC1777911B8D8,
    		0x083B34B7BA6101EF,
    		0x44FEB2C21DB84A3F,
    		0x4A0BB446E329A9C0,
    		0xF1A79D752D1EC49C,
    		0x9FF85FAD77B4C583,
    		0x5727145E7870472B,
    		0x000750FB3697B13B,
    		0x73975A7CF40A3C6C,
    		0x3A000F6749358616,
    		0x44E3080DADAB6D28,
    		0xF9275844D45CEBE8,
    		0x868952246DFA7B6A,
    		0x1AFA39FEBDF6F853,
    		0xA85760EC5594C5C7,
    		0xC445177C16D5C877,
    		0x60A47D5DBE949010,
    		0x7459BD63218D7825,
    		0x1BA07A7D6EB1C7A1,
    		0xA097BB3FD37C03E7,
    		0x00B61F635E40EBF9,
    		0x2735CBA14BFBECF3,
    		0xFFB52E4B27A0BDE7,
    		0xE095ABAA256237DE,
    		0xE6D1EFB9A56C2B62,
    		0x013F26AC41DD466B,
    		0x7C23460BE8EBBC8C,
    		0x4D3AFABD9B14F366,
    		0xB44FFD7BBF57FCE7,
    		0x1A2D9550EB4398D8,
    		0x9577F4AEEC267D33,
    		0xC232EF5C9C231698,
    		0xEE615EC86B571CC1,
    		0x96BFF499A005B8CF,
    		0x8036C04FA6F2E8F7,
    		0xAE0A121DD676EC9D,
    		0x1600B01FB57E033C,
    		0x25AAB9FF1E5F4AB8,
    		0x681A813967C4CE91,
    		0xD207C5416BB070A8,
    		0xBA24499EE4E4A661,
    		0xD3FEB1B2A5FB81AC,
    		0xB9DFFE83BE64CD36,
    		0xBCD5DB98E8A7C104,
    		0xD4CC331D8F34FBC6,
    		0x92E569A8CDD402E8,
    		0x0C92FEB8E2D9DBAC,
    		0xE3830C6D9F40CDD7,
    		0x53A134E0C59F0A30,
    		0xD45A3E4D7C68E055,
    		0x8BBF81213270BB93,
    		0x13042EA88707B2D1,
    		0x10DAD549B15DB9C8,
    		0xCAB2174265D47700,
    		0xD9929FCF628A646D,
    		0x94519A3667910B82,
    		0x076A29084C089927,
    		0x504896DE68F26C69,
    		0x907A1619BF9E8690,
    		0x50587EE5C7812217,
    		0x5C298AF0D586128C,
    		0x2B2B94ECD9B33EDE,
    		0x33A1E122F0BDA601,
    		0x4B0B0B6CAA76AD07,
    		0x2FBCA98BC87715AC,
    		0xE091B1F7958E4296,
    		0xFD06C5F71F11D734,
    		0xEF78B83E45F0FCE1,
    		0x4C557EB011D5AFD0,
    		0x9D0EEC1ED4AAF3EE,
    		0x386A923DD87BB7AE,
    		0x5AABC901B093C025,
    		0x008D7A4D6E40DE96,
    		0xBF17A7F509D3E6EB,
    		0x5E85745A486C015F,
    		0xF0ACEAC44E5949EB,
    		0xA0401174F2961525,
    		0x263BB1CC8E49613A,
    		0xC830D713F7B81825,
    		0x8159AEEFFBBEBA6F,
    		0xF08C55E6E7207AD4,
    		0x257BA34503A51325,
    		0x1D5123778C5C7F20,
    		0x676B390369A29F1D,
    		0x1EC3734E1C179685,
    		0xD3632C37D12958B5,
    		0xBCCD4550527D2EB3,
    		0x73107EFEA5F12C30,
    		0x06BEB78BC41D7A0E,
    		0xE7FF11EFF0A4D6CF,
    		0x8C3F58B376CEC2FA,
    		0x980A84465C4797FE,
    		0xE6B7915550DA1ED7,
    		0x5F69F5750D28B575,
    		0x6A9E5182E5076F3C,
    		0x5E5C15A39023C5C8,
    		0x3B1AE2F7EBFF8C56,
    		0x568E071EA7D641C9,
    		0x7B1631B170FCC5C6,
    		0xBA7C6FD28A000DBD,
    		0x82D8DEB7E394D8D5,
    		0x726208A316DC7772,
    		0x09045AD81090CA5C,
    		0x8A456668E43A3597,
    		0xC5624D58D182755F,
    		0x15CBD2E3662F49DA,
    		0x632070310F36FB7B,
    		0x362A699188093162,
    		0xC56B35E0C32A413A,
    		0x2234CEE2B84737B3,
    		0x09754420DD4F0EFA,
    		0xD95A26C9443B3D2D,
    		0x4593D5FA2247070D,
    		0xEC1414BFEF9D4CE3,
    		0x3EACDE005DF15CFD,
    		0x69448CFE92F708D6,
    		0xE38F3885EA6EBB66,
    		0xBF812E507677FCA3,
    		0xE0732EAFD3A54DBA,
    		0x235C8EA963473CE7,
    		0xCC3CE131B50AB8BD,
    		0x57ED794E4DA51112,
    		0x8AFDA6D85FA30A29,
    		0xA89ACA8F1A7AFE4E,
    		0xD910E092AD7701ED,
    		0x0036133818004C09,
    		0x17A05ECA4BA14AD1,
    		0x3BFB230B76D95371,
    		0x4E775CC48E4D396B,
    		0x613CA8B69FB6DA10,
    		0x8AA7D93A49BB7140,
    		0x65D1D23CF33B4656,
    		0xC4F262129E281036,
    		0x231AD5222753D43E,
    		0xB2B256207CC8DEBA,
    		0x3A3E6EE39A3DA1DC,
    		0x53A06FD1C966503B,
    		0xE7928E58D690C419,
    		0x1DB373EB6646DBBC,
    		0xA4FE1A5B3FAC3788,
    		0xFFEA320967D19280,
    		0x0DB1747AE3BAD504,
    		0x068FFBAB20413403,
    		0xC812F1AC668DC5AB,
    		0x692FA79366593AD7,
    		0x4063C2D7758B6679,
    		0x1DC475C3A1505FAE,
    		0xA65A6BBB3D97DD79,
    		0xD01B13FDF03D3511,
    		0xE3D5338C314F48D3,
    		0x4A8678D5CA1C884F,
    		0x2E0FA7689173B54D,
    		0x8446DEFC0C8E6511,
    		0x8B9E4C38676D2948,
    		0xFA40F1F6DB52738A,
    		0x952C724DC810320F,
    		0x65C68F62349B74E1,
    		0xFD0C9B4864F290E7,
    		0x23BC80D87D35A149,
    		0x654FF2859D01F869,
    		0x91C3F523475623E6,
    		0xF7DF0C77D2B572FE,
    		0xDD1EF33CC7F158D3,
    		0x204BE0D81828AEA3,
    		0x5C9F499045E7B0AE,
    		0x0093270C5493824F,
    		0x4D6190AE3FB43859,
    		0xA482754E9212B7F4,
    		0x7C4F628636D706E7,
    		0x138FAF4943A29789,
    		0xE85A662310F18D30,
    		0xBCB4A0C7F752357A,
    		0x53AA930940E832F5,
    		0x39533087202FA224,
    		0xB346BCFE1E105405,
    		0x075AB02BDBBBE452,
    		0x2C59015CF068F5D5,
    		0xE15C8A1CAEC05273,
    		0x5B19D0F08822AAAE,
    		0x72069AF9BDA2A20A,
    		0xFF7D5A3003DFB81A,
    		0xE612C5FC7A469896,
    		0xB07D196D692829C2,
    		0xFBCDD213528FAEBE,
    		0xDD502F6BCB326A21,
    		0x093E4F0A48F5E9BB,
    		0x5527F39DDD0DE137,
    		0x5203FE756AC99860,
    		0xC273A031420CD429,
    		0x6B31867CDD6F060A,
    		0x6E5195169AFDCB8E,
    		0x7EEFAD63BA1CA02A,
    		0xCCDF0A49A1429324,
    		0xE2BC993073847565,
    		0x36E7B0C8A5365ACC,
    		0xE7F677D22F6D17B1,
    		0x01766B9CBD4F4CFE,
    		0x6BBE4D6BB884AC85,
    		0x19DA2D742EDD633E,
    		0xF02D92809BC6C53B,
    		0x6BF28230649E1D73,
    		0xFDFD6ADB1D05CC1F,
    		0xF8E8C47BF6A51A03,
    		0x6E19ADFC488543A7,
    		0x8AEDA9F0FA8BF4F1,
    		0xDB01C2C4156B3C49,
    		0x8CC4977823C32C73,
    		0xFB3C01E367B01288,
    		0x8A46653F5DC8E448,
    		0x2BEAB87362A3102D,
    		0xDB05C8303F12CCB5,
    		0x131C6BD16E9FB12E,
    		0x9E9D90E7F5813BB6,
    		0xB8BF2C3853753471,
    		0xAA6833BE2276B219,
    		0x0292B86FC43BF67D,
    		0x3E2BEAF39493FF8F,
    		0xFD9929B38951B5E2,
    		0x04C1F48FA6B99093,
    		0x65ADC073244FB88D,
    		0x2C37A768791F5E98,
    		0x57CBBABDD96E3A49,
    		0xD03B6000ED6BF583,
    		0x5854EC7BF2CAC1D9,
    		0x3FD02E0F33AED0F6,
    		0x7DA04AFC70CA2F75,
    		0xE217E6AE26810FC1,
    		0xB253819AB9D90341,
    		0xF554AB7C82FAA387,
    		0x4780A3A7D8EE4B8D,
    		0x9C59202276EA2E23,
    		0x06395339971A4E9F,
    		0x7D2784B3786CC47A,
    		0xCF1D50DF4E5F3D61,
    		0x6D54DDCDFB010056,
    		0x6310148E52106610,
    		0x8B75C3FBED364886,
    		0xD5EFD1C78AE4F7AB,
    		0x76705BB085DB385E,
    		0x6A8D2DCED159560A,
    		0xAF55C18464D62312,
    		0x37D270094CDCC92F,
    		0x62979B5EB1575B4E,
    		0xD7860D9E4F172B95,
    		0xF8603900918BA17B,
    		0xBC85A3E7495CB24B,
    		0xE7A217F1422BD4EF,
    		0x2B442E364D9D381B,
    		0xEE47F9019BD56C77,
    		0xA1AF7517AB8FC87F,
    		0xF6B036836C171FA4,
    		0x76150425A4E9E7B2,
    		0xB67EC4DBC1CF844D,
    		0xE2F7FDE234C86143,
    		0x312C5240AB67F93F,
    		0xD6D27D7440315C32,
    		0x916DF78815BD1F97,
    		0x362B20D4C069816F,
    		0x74097CDEDAEBC26E,
    		0xF46D4889E22240F4,
    		0xA994E65DE3DE1859,
    		0x6EAD6AB4B4F6CDC2,
    		0xD26543958149E85D,
    		0x8010057A528F69C9,
    		0x714060B6A9F59880,
    		0xBDB3B993B90F5165,
    		}; //=0x12A1265E41111472;// 0x6F30BBF444111454;  12A1165E// Example 32-bit challenge


 //   */
    //    u64 ichallenge;
//    u64 challenge_array=0xA427C40A300E0F92;
    u64 oresponse;              // Output response 64-64:0x72FDFE47


    for (int i=0; i<chall_number ; i+=2) {

    	write_challenge(challenge_array1[i],challenge_array1[i+1]);

    	oresponse = read_response();

 //   	printf("Challenge: 0x%016llX\n", challenge_array[i]);
    	printf(" 0x%016llX\n", oresponse);
    	for (volatile int delay = 0; delay < 500000; delay++);

    }


   // printf("\n\n");
    cleanup_platform();
    return 0;
}
